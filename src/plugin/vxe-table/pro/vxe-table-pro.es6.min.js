/**
 * vxe-table pro v1.0.8
 */
import XEUtils from 'xe-utils/ctor'
/* eslint-disable */
 (function(e){var ae=Math.abs,ie=Math.max,fe=Math.min,de=Math.floor;function t(e){clearTimeout(e._msTout),e._msTout=null}function l(e){e.stopPropagation(),o(e)}function o(e){e.preventDefault()}function r(e,t){return e.querySelector(t)}function n(e){return e.getBoundingClientRect()}function s(e){e&&(e.style.display="block")}function a(e){e&&(e.style.display="")}function i(e,t){e&&e.className&&ye(e.className.split(" "),e=>e!==t).concat([t]).join(" ")}function f(e,t){e&&e.className&&ye(e.className.split(" "),e=>e!==t).join(" ")}function d(e){const t=document.createElement("span");return t.className="vxe-table--cell-main-area",e.appendChild(t),t}function c(e,t){t?e.setAttribute("half",1):e.removeAttribute("half")}function u(e,t){s(e),e.style.height=`${t.height}px`,e.style.width=`${t.width}px`,e.style.left=`${t.left}px`,e.style.top=`${t.top}px`}function p(e,t){we(e.$el.querySelectorAll(".vxe-table--cell-area"),t)}function m(e,t){p(e,e=>{const l=e.children[t];a(l)})}function h(e,t){const{editStore:l}=t,{actived:o}=l,{column:r,row:n}=o;if(r&&n){const{offsetRow:l,offsetColumn:r}=x(t,o.row,o.column);t.clearActived(e),t.$nextTick(()=>t.setCellAreas([{type:$e,startRow:l,endRow:l,startColumn:r,endColumn:r}]))}}function g(e,t,l){const{mergeList:o}=e;return ve(o,({row:e,col:o,rowspan:r,colspan:n})=>t>=e&&t<e+r&&l>=o&&l<o+n)}function w(e,t){let l=e.offsetY,o=e.offsetX,r=e.target;for(;r&&r!==document;){if(r===t)return{offsetY:l,offsetX:o};l+=r.offsetTop,o+=r.offsetLeft,r=r.offsetParent}return{offsetY:0,offsetX:0}}function v(e){const{mergeList:t,afterFullData:l,visibleColumn:o}=e,r=e.getCellAreas();return ye(t,({row:e,col:t,rowspan:n,colspan:s})=>Ae(r,r=>{const{rows:a,cols:i}=r,f=he(l,Te(a)),d=he(l,Fe(a)),c=he(o,Te(i)),u=he(o,Fe(i));return e>=f&&e+n-1<=d&&t>=c&&t+s-1<=u}))}function C(e,t){const{$vxe:l,afterFullData:o,visibleColumn:r}=e,{modal:n}=l,s=e.getCellAreas(),a=s.length;let i=!1;const f={};for(let d=0;d<a;d++){const e=s[d],{rows:t,cols:a}=e;for(let e=0,s=t.length;e<s;e++){const s=t[e],d=he(o,s);for(let t=0,o=a.length;t<o;t++){const o=a[t],c=he(r,o),u=d+":"+c;if(f[u])return void(n&&n.message({message:l.t("vxe.pro.area.multiErr"),status:Ne,id:Le}));!i&&(0<e||0<t)&&Re(Ie(s,o.property))&&(i=!0),f[u]=!0}}}const d=v(e);let c=!1;if(d.length)e.removeMergeCells(d);else{if(Ae(s,({rows:e,cols:t})=>e.length===o.length||t.length===r.length))return void(n&&n.message({message:l.t("vxe.pro.area.mergeErr"),status:Ne,id:Le}));c=!0,e.setMergeCells(s.map(({rows:e,cols:t})=>(we(e,(e,l)=>{we(t,(t,o)=>{(0<l||0<o)&&Ee(e,t.property,null)})}),{row:Te(e),col:Te(t),rowspan:e.length,colspan:t.length})))}const u=s.map(({rows:e,cols:t})=>({rows:e,cols:t}));e.emitEvent("cell-area-merge",{status:c,targetAreas:u},t)}function x(e,t,l){const{afterFullData:o,visibleColumn:r}=e,n=he(o,t),s=he(r,l),a=g(e,n,s);if(a){const{row:e,col:n}=a;t=o[e],l=r[n]}return{offsetRow:t,offsetColumn:l}}function b(e,t,l){const{mergeList:o,afterFullData:r,visibleColumn:n}=e;if(o.length){const o=Te(t),s=Te(l),a=he(r,o),i=he(n,s),f=a+t.length-1,d=i+l.length-1;let c=a,u=i,p=f,m=d;for(let t=c;t<=p;t++)for(let l=u;l<=m;l++){const o=g(e,t,l);if(o){const{row:e,col:r,rowspan:n,colspan:s}=o,a=e+n-1,i=r+s-1;let f=!1;e<c&&(f=!0,c=e),r<u&&(f=!0,u=r),a>p&&(f=!0,p=a),i>m&&(m=i,f=!0),f&&(t=c,l=u)}}return{rows:me(r,c,p+1),cols:me(n,u,m+1)}}return{rows:t,cols:l}}function R(e,t,l,o,r,n){const{afterFullData:s,visibleColumn:a,scrollYLoad:i,scrollYStore:f}=e,{rowHeight:d}=f;if(i)return(de(n/d)+1)*d;let c=0;const u=(r?"next":"previous")+"ElementSibling";if(r&&o){const{row:e,col:r}=o;t=s[e],l=a[r]}const p=e.getCell(t,l);for(let s=p.parentNode;s&&n>=c;)c+=s.offsetHeight,s=s[u];return c}function y(e,t,l,o,r,n){const{visibleColumn:s}=e;let a=0;if(r)for(let e=he(s,l)+1,t=s.length;e<t;e++){const t=s[e];if(a+=t.renderWidth,a>=n)return a}else for(let e=he(s,l)-1;0<=e;e--){const t=s[e];if(a+=t.renderWidth,a>=n)return a}return a}function A(e,t,l,o,r,n){const{afterFullData:s,scrollYLoad:a,scrollYStore:i}=e;let f=0,d=0,c=[];const u=he(s,t);if(a){const{rowHeight:e}=i;d=de(n/e)+1,f=d*e}else{const e=(r?"next":"previous")+"ElementSibling";for(r&&(d++,f+=o.offsetHeight);o&&n>=f;)f+=o.offsetHeight,o=o[e],d++}return c=r?me(s,u,fe(s.length+1,u+d)):me(s,ie(0,u-d),u+1),{moveHeight:f,moveSize:d,rows:c}}function I(e,t,l,o,r,n){const{visibleColumn:s}=e;let a=0;const i=[l];let f=he(s,l);if(r){a+=l.renderWidth,f++;for(let e=s.length;f<e&&!(a>=n);f++){const e=s[f];i.push(e),a+=e.renderWidth}}else for(f--;0<=f&&!(a>=n);f--){const e=s[f];i.unshift(e),a+=e.renderWidth}return{moveWidth:a,moveSize:i.length,cols:i}}function E(e,t,l){const{visibleColumn:o}=e,{left:r,width:n}=l;let s=0;const a=[];for(let i=0,f=o.length;i<f;i++){const e=o[i];if(s>=r&&a.push(e),s+=e.renderWidth,s>=r+n)return a}return a}function T(e,t,l){const{afterFullData:o,scrollYLoad:r,scrollYStore:n}=e,{top:s,height:a}=l;if(r){const{rowHeight:e}=n,t=de(s/e);return me(o,t,t+de(a/e))}let i=0;const f=[];for(;t&&i<s+a;)i>=s&&f.push(e.getRowNode(t).item),i+=t.offsetHeight,t=t.nextElementSibling;return f}function F(e,t){const{visibleColumn:l,afterFullData:o,scrollYLoad:n,scrollYStore:s,elemStore:a}=e,{type:i,area:f,column:d,row:c}=t;let p=d,m=c;const h=a[`${p.fixed||"main"}-body-wrapper`]||a["main-body-wrapper"],w=r(h,".vxe-table--cell-area"),v=w.children,C=v[4];let x=he(l,p),b=he(o,m);if(f&&-1<x&&-1<b){let r=0,a=0,h=0,w=0;const v=g(e,b,x);if(v){const{row:r,col:n,rowspan:s,colspan:a}=v;return b=r,m=o[b],x=n,p=l[x],t.rows=me(o,b,b+s),t.cols=me(l,x,x+a),pe($(e,t),{type:i,area:f,column:d,row:c})}if(r+=d.renderWidth,we(me(l,0,x),e=>{w+=e.renderWidth}),n){const{rowHeight:e}=s;if(h=b*e,v){const{rowspan:t}=v;a=e*t}else a=e}else{const t=e.getCell(m,p),l=t.parentNode;h=l.offsetTop,a=t.offsetHeight}const R={type:i,area:f,column:d,row:c,top:h,left:w,width:r,height:a};return u(C,R),R}return null}function S(e,t,l,o,n,i){const{showOverflow:f,spanMethod:p,scrollXLoad:m,columnStore:h,keyboardConfig:w,keyboardOpts:v,mergeList:C,visibleColumn:x,afterFullData:b,scrollYLoad:R,scrollYStore:y,elemStore:A}=e,{type:I,cols:F}=t,S=A[`${o||"main"}-body-wrapper`]||A["main-body-wrapper"],$=r(S,".vxe-table--cell-area"),D=$.children,k=D[0],W=D[1],V=D[2],L=D[3],N=D[4],M=r(S,".vxe-body--row"),H=M.firstChild;let O=Te(i),Y=Te(n),_=Fe(i),X=Fe(n),K=he(x,Y),j=he(b,O),q=he(x,X),z=he(b,_),B=0,P=0;const G=[];if(C.length&&we(i,(t,l)=>{const o=he(b,t);we(n,(t,r)=>{const s=he(x,t),a=g(e,o,s);if(a){const{row:e,col:t,rowspan:o,colspan:s}=a;0===l&&0===r&&(j=e,O=b[j]),l===i.length-1&&r===n.length-1&&(z=e,B=o-1,_=b[z]),0===l&&0===r&&(K=t,Y=x[K]),l===i.length-1&&r===n.length-1&&(q=t,P=s-1,X=x[q]),a&&-1===he(G,a)&&G.push(a)}})}),-1<K&&-1<q&&-1<j&&-1<z){let r=0,i=0,g=0,b=0,A=me(x,0,K);if("right"===o){const e=h[`${o}List`];let t=[];C.length||p||w&&v.isMerge||(o&&f?t=e:m&&o&&(t=e)),t.length&&(A=me(t,0,he(t,x[K])))}if(we(A,e=>{b+=e.renderWidth}),we(me(x,K,q+P+1),e=>{r+=e.renderWidth}),R){const{rowHeight:e}=y;g=j*e,i=(z+B+1-j)*e}else{const t=e.getCell(O,Y),l=e.getCell(_,X),o=t.parentNode,r=l.parentNode;g=o.offsetTop,i=r.offsetTop+l.offsetHeight-g}const S={el:t.el,leftEl:t.leftEl,rightEl:t.rightEl,type:I,cols:[],rows:[],top:g,left:b,width:r,height:i},D=o&&n.length!==F.length;if(S.cols=E(e,H,S),S.rows=T(e,M,S),s($),I===$e)l?s(k.firstChild):a(k.firstChild),c(k,D),u(k,S);else if(I===De)c(W,D),u(W,S);else if(I===ke)c(V,D),u(V,S);else if(I===We){const e=o?`${o}El`:"el",t=S[e]||d(L);S[e]=t,c(t,D),u(t,S)}else I===Ve&&(c(N,D),u(N,S));return S}return null}function $(e,t){const{type:l,cols:o,rows:r}=t,n=ye(o,e=>"left"===e.fixed),s=ye(o,e=>"right"===e.fixed);return l!==We&&m(e,l),n.length&&S(e,t,o.length===n.length,"left",n,r),s.length&&S(e,t,!0,"right",s,r),S(e,t,!s.length,null,o,r)}function D(e,t){const{visibleColumn:l,afterFullData:o}=e,{startColumn:r,endColumn:n,startRow:s,endRow:a}=t,i=he(o,s),f=he(o,a),d=he(l,r),c=he(l,n),u=me(o,i,f+1),p=me(l,d,c+1),{rows:m,cols:h}=b(e,u,p);return t.rows=m,t.cols=h,$(e,t)}function k(e,t){const l=[],o=[];if(t){const{afterFullData:r,visibleColumn:n,clipOpts:s}=e,{cols:a,rows:i}=t,f=s.copyMethod||s.getMethod;we(i,t=>{const s=[],i=[],d=he(r,t);we(a,l=>{const o=he(n,l),r=g(e,d,o);let a="";if(r){const{row:e,col:n,rowspan:i,colspan:c}=r;d===e&&o===n&&(a=Re(f?f({row:t,column:l}):Ie(t,l.property)),s.push(`<td rowspan="${i}" colspan="${c}">${a}</td>`))}else a=Re(f?f({row:t,column:l}):Ie(t,l.property)),s.push(`<td>${a}</td>`);i.push(a)}),l.push(i),o.push(`<tr>\n${s.join("\n")}\n</tr>`)})}const r=o.length?["<html>","<head>","<meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui\">","</head>","<body>","<table border=0 cellpadding=0 cellspacing=0>",o.join("\n"),"</table>","</body>","</html>"]:[];return{area:t,cellValues:l,text:l.map(e=>e.join("\t")).join("\n"),html:r.join("\n")}}function W(e,t,l){const{$vxe:r,clipOpts:n,filterStore:s}=e,{modal:a}=r,i=n.beforeCopyMethod||n.beforeGetMethod,f=e.getCellAreas(),d={text:"",html:""};let c,u=!1,p=[];if(!s.visible){if(t&&o(t),1===f.length){const t=Te(f);if(t){const{rows:o,cols:r}=t,n=me(o,0),s=me(r,0);if(p=[{rows:n,cols:s}],!i||!1!==i({targetAreas:p,$table:this})){const o=pe({},t,{isCut:l,type:De,rows:n,cols:s});u=!0,c=k(e,t),d.text=c.text,d.html=c.html,e.copyAreaMpas=pe(o,$(e,o))}}}else 1<f.length&&a&&a.message({message:r.t("vxe.pro.area.multiErr"),status:Ne,id:Le});t&&e.emitEvent(`cell-area-${l?"cut":"copy"}`,{status:u,targetAreas:u?p:[],cellValues:c?c.cellValues:[]},t),r.clipboard=d}return d}function V(e,t,l){const{$vxe:r,clipOpts:n,copyAreaMpas:s,filterStore:a}=e,i=n.pasteMethod||n.setMethod,f=n.beforePasteMethod||n.beforeSetMethod,{modal:d}=r,c=e.getCellAreas();let u=!1,p=[];if(!a.visible){if(t&&o(t),1===c.length){const t=Te(c),{rows:o,cols:n}=t,a=Te(n),m=Te(o),h=[],w=c.map(({rows:e,cols:t})=>({rows:e,cols:t}));if(s&&s.isCut){const{cols:t,rows:l}=s;we(l,e=>{we(t,t=>{Ee(e,t.property,null)})}),e.clearCopyCellArea()}const{text:v}=l;if(we(v.replace(/\n$/,"").split("\n"),e=>{const t=[];we(e.split("\t"),e=>{t.push(e)}),h.push(t)}),1===h.length&&1===h[0].length){if(p=w,!f||!1!==f({currentAreas:w,targetAreas:p,cellValues:h,$table:this})){const e=h[0][0];u=!0,we(c,t=>{const{rows:l,cols:o}=t;we(l,t=>{we(o,l=>{i?i({row:t,column:l,cellValue:e}):Ee(t,l.property,e)})})})}}else if(1===c.length){const{visibleColumn:t,afterFullData:l}=e;let o=m,n=a;const s=he(l,m),c=he(t,a);if(-1<c&&-1<s){const v=[],C=[],x=[],b=h.length,R=h[0].length;for(let i=0;i<b;i++){const f=h[i],u=s+i,p=l[u];if(p){const h=[];for(let p=0;p<R;p++){const w=f[p],v=c+p,x=t[v];if(x){const f=g(e,u,v);if(f){const{row:i,col:u,rowspan:p,colspan:h}=f;if(s+b<i+p||c+R<u+h)return o=l[i+p-1],n=t[u+h-1],e.setCellAreas([{type:$e,startColumn:a,endColumn:n,startRow:m,endRow:o}],{column:a,row:m}),void(d&&d.message({message:r.t("vxe.pro.area.mergeErr"),status:Ne,id:Le}))}i||C.push(x),h.push(w)}}v.push(p),x.push(h)}}p=[{rows:v,cols:C}],f&&!1===f({currentAreas:w,targetAreas:p,cellValues:x,$table:this})||(u=!0,we(x,(e,r)=>{const a=l[s+r];a&&(o=a,we(e,(e,l)=>{const o=t[c+l];o&&(n=o,i?i({row:a,column:o,cellValue:e,$table:this}):Ee(a,o.property,e))}))}),e.setCellAreas([{type:$e,startColumn:a,endColumn:n,startRow:m,endRow:o}],{column:a,row:m}))}}else d&&d.message({message:r.t("vxe.pro.area.multiErr"),status:Ne,id:Le})}else 1<c.length&&d&&d.message({message:r.t("vxe.pro.area.multiErr"),status:Ne,id:Le});t&&e.emitEvent("cell-area-paste",{status:u,targetAreas:u?p:[]},t)}}function L(e,t,l){const{afterFullData:o,visibleColumn:r}=e,n=he(o,Te(t)),s=he(r,Te(l));for(let o=0,r=t.length;o<r;o++){const t=n+o;for(let o=0,a=l.length;o<a;o++){const l=s+o,i=g(e,t,l);if(i){const{row:e,col:t,rowspan:l,colspan:o}=i;if(n>e||n+r<e+l||s>t||s+a<t+o)return!1}}}return!0}function N(e,t,l,o){const{afterFullData:r,visibleColumn:n}=e,s=he(r,l),a=he(n,o);if(t.length){if(1===t.length){const{cols:l,rows:o}=Te(t);if(1===l.length&&1===o.length)return!0;else{const t=he(r,Te(o)),i=he(n,Te(l)),f=g(e,s,a);if(f){const{row:e,col:r,rowspan:n,colspan:s}=f;if(t===e&&o.length===n&&i===r&&l.length===s)return!0}}}return!1}return!0}function M(e,t,l,o){const{afterFullData:r,visibleColumn:n}=e;let s=r[t];const a=n[l];if(s){const t=he(r,s),l=he(n,a),o=g(e,t,l);if(o){const{row:e}=o;t!==e&&(s=r[e])}}else if(o)return l--,0>l&&(l=n.length-1),t=r.length-1,M(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function H(e,t,l,o){const{afterFullData:r,visibleColumn:n}=e;let s=r[t];const a=n[l];if(s){const t=he(r,s),l=he(n,a),o=g(e,t,l);if(o){const{row:e,rowspan:l}=o;t!==e&&(s=r[e+l-1+1])}}else if(o)return l++,l>n.length-1&&(l=0),t=0,H(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function O(e,t,l,o){const{afterFullData:r,visibleColumn:n}=e,s=r[t];let a=n[l];if(a){const t=he(r,s),l=he(n,a),o=g(e,t,l);if(o){const{col:e}=o;l!==e&&(a=n[e])}}else if(o)return t--,0>t&&(t=r.length-1),l=n.length-1,O(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function Y(e,t,l,o){const{afterFullData:r,visibleColumn:n}=e,s=r[t];let a=n[l];if(a){const t=he(r,s),l=he(n,a),o=g(e,t,l);if(o){const{col:e,colspan:t}=o;l!==e&&(a=n[l+t-1+1])}}else if(o)return t++,t>r.length-1&&(t=0),l=0,Y(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function _(e,t,l,o,r){const{afterFullData:n,visibleColumn:s}=e,a=t[l],{cols:i,rows:f}=a;let d=f[o];const c=i[r];if(d){const u=he(n,d),p=he(s,c),m=g(e,u,p);if(m){const{row:s,col:h}=m,g=he(f,n[s]);return u===s&&p===h?(o=g,d=f[r],{offsetArea:a,offsetRow:d,offsetColumn:c}):(p===h?(o=g,d=f[o]):(o=g-1,0>o&&(r--,0>r&&(r=i.length-1),o=f.length-1)),_(e,t,l,o,r))}return{offsetArea:a,offsetRow:d,offsetColumn:c}}return r--,0>r?(l--,0>l&&(l=t.length-1),o=t[l].rows.length-1,r=t[l].cols.length-1):o=f.length-1,_(e,t,l,o,r)}function X(e,t,l,o,r){const{afterFullData:n,visibleColumn:s}=e,a=t[l],{cols:i,rows:f}=a;let d=f[o];const c=i[r];if(d){const u=he(n,d),p=he(s,c),m=g(e,u,p);if(m){const{row:s,col:h,rowspan:g}=m,w=he(f,n[s]);return u===s&&p===h?(o=w,d=f[o],{offsetArea:a,offsetRow:d,offsetColumn:c}):(p===h?(o=w+g-1+1,d=f[o]):(o=w+g-1+1,o>f.length+1&&(r++,o>i.length-1&&(r=0),o=0)),X(e,t,l,o,r))}return{offsetArea:a,offsetRow:d,offsetColumn:c}}return o++,r++,o>f.length-1&&(o=0),r>i.length-1&&(l++,l>t.length-1&&(l=0),r=0),X(e,t,l,o,r)}function K(e,t,l,r,n,s,a){o(e);const i=13===e.keyCode,{afterFullData:f,visibleColumn:d}=t,{row:c,column:u}=l,p=t.getCellAreas(),m=!i||N(t,p,c,u);if(m){let e=he(f,c),l=he(d,u),o=c,p=u;const m=g(t,e,l);if(n){if(m){const{row:t}=m;e=t}const{offsetRow:r,offsetColumn:n}=M(t,e-1,l,i);o=r,p=n}else if(a){if(m){const{row:t,rowspan:l}=m;e=t+l-1}const{offsetRow:r,offsetColumn:n}=H(t,e+1,l,i);o=r,p=n}else if(r){if(m){const{col:e}=m;l=e}const{offsetRow:r,offsetColumn:n}=O(t,e,l-1);o=r,p=n}else if(s){if(m){const{col:e,colspan:t}=m;l=e+t-1}const{offsetRow:r,offsetColumn:n}=Y(t,e,l+1);o=r,p=n}o&&p&&(t.scrollToRow(o,p),t.setCellAreas([{type:$e,startColumn:p,endColumn:p,startRow:o,endRow:o}],{column:p,row:o}))}else{const e=t.getActiveCellArea(),{area:l,row:o,column:r}=e,s=be(p,e=>e===l);let a=p[s],i=o,f=r;if(a){const{cols:e,rows:l}=a,d=he(l,o),c=he(e,r),{offsetArea:u,offsetRow:m,offsetColumn:h}=n?_(t,p,s,d-1,c):X(t,p,s,d+1,c);a=u,i=m,f=h}i&&f&&t.scrollToRow(i,f).then(()=>{t.setActiveCellArea({area:a,column:f,row:i})})}}function j(e,t,l,r,n,s,a){o(e);const{afterFullData:i,visibleColumn:f}=t,{area:d,row:c,column:u}=l,{rows:p,cols:m}=d;let h=Te(p),w=Fe(p),v=Te(m),C=Fe(m);const x=he(i,c),R=he(f,u);let y=he(i,h),A=he(f,v),I=he(i,w),E=he(f,C),T=p,F=m;const S=g(t,x,R);if(n||a){if(n){if(we(m,e=>{const l=he(f,e),o=g(t,I,l);if(o){const{row:e}=o;I=fe(I,e)}}),I>(S?x+S.rowspan-1:x))I-=1,w=i[I];else{if(0>=y)return;y-=1,h=i[y]}}else if(we(m,e=>{const l=he(f,e),o=g(t,y,l);if(o){const{row:e,rowspan:t}=o;y=ie(y,e+t-1)}}),y<(S?x+S.rowspan-1:x))y+=1,h=i[y];else{if(I>=i.length-1)return;I+=1,w=i[I]}const{rows:e,cols:l}=b(t,me(i,y,I+1),F);T=e,F=l}else{if(r){if(we(p,e=>{const l=he(i,e),o=g(t,l,E);if(o){const{col:e}=o;E=fe(E,e)}}),E>(S?R+S.colspan-1:R))E-=1,C=f[E];else{if(0>=A)return;A-=1,v=f[A]}}else if(we(p,e=>{const l=he(i,e),o=g(t,l,A);if(o){const{col:e,colspan:t}=o;A=ie(A,e+t-1)}}),A<(S?R+S.colspan-1:R))A+=1,v=f[A];else{if(E>=f.length-1)return;E+=1,C=f[E]}const{rows:e,cols:l}=b(t,T,me(f,A,E+1));T=e,F=l}h=Te(T),w=Fe(T),v=Te(F),C=Fe(F),n||a?t.scrollToRow(Te(p)===h?w:h):t.scrollToColumn(Te(m)===v?C:v),t.setCellAreas([{type:$e,startRow:h,endRow:w,startColumn:v,endColumn:C}],{column:u,row:c})}function q(e,t,l,o,r){const{afterFullData:n,visibleColumn:s}=e,a=t[l],{cols:i,rows:f}=a,d=f[o];let c=i[r];if(c){const u=he(n,d),p=he(s,c),m=g(e,u,p);if(m){const{row:n,col:h}=m,g=he(i,s[h]);return u===n&&p===h?(r=g,c=i[r],{offsetArea:a,offsetRow:d,offsetColumn:c}):(u===n?(r=g,c=i[r]):(r=g-1,0>r&&(o--,0>o&&(o=f.length-1),r=i.length-1)),q(e,t,l,o,r))}return{offsetArea:a,offsetRow:d,offsetColumn:c}}return o--,0>o?(l--,0>l&&(l=t.length-1),o=t[l].rows.length-1,r=t[l].cols.length-1):r=i.length-1,q(e,t,l,o,r)}function z(e,t,l,o,r){const{afterFullData:n,visibleColumn:s}=e,a=t[l],{cols:i,rows:f}=a,d=f[o];let c=i[r];if(c){const u=he(n,d),p=he(s,c),m=g(e,u,p);if(m){const{row:n,col:h,colspan:g}=m,w=he(i,s[h]);return u===n&&p===h?(r=w,c=i[r],{offsetArea:a,offsetRow:d,offsetColumn:c}):(u===n?(r=w+g-1+1,c=i[r]):(r=w+g-1+1,r>i.length-1&&(o++,o>f.length-1&&(l++,l>t.length-1&&(l=0),o=0),r=0)),z(e,t,l,o,r))}return{offsetArea:a,offsetRow:d,offsetColumn:c}}return o++,o>f.length-1?(l++,l>t.length-1&&(l=0),o=0,r=0):r=0,z(e,t,l,o,r)}function B(e,t,l,o){const{afterFullData:r,visibleColumn:n}=t,{column:s,row:a}=l,i=t.getCellAreas(),f=N(t,i,a,s);if(f){const e=he(r,a);let l=he(n,s),i=a,f=s;const d=g(t,e,l);if(d){const{col:e,colspan:t}=d;l=o?e:l+t-1}const{offsetRow:c,offsetColumn:u}=o?O(t,e,l-1,!0):Y(t,e,l+1,!0);i=c,f=u,i&&f&&(t.scrollToRow(i,f),t.setCellAreas([{type:$e,startColumn:f,endColumn:f,startRow:i,endRow:i}],{column:f,row:i}))}else{const e=t.getActiveCellArea(),{area:l,row:r,column:n}=e,s=be(i,e=>e===l);let a=i[s],f=r,d=n;if(a){const{cols:e,rows:l}=a,c=he(l,r),u=he(e,n),{offsetArea:p,offsetRow:m,offsetColumn:h}=o?q(t,i,s,c,u-1):z(t,i,s,c,u+1);a=p,f=m,d=h}f&&d&&t.scrollToRow(f,d).then(()=>{t.setActiveCellArea({area:a,column:d,row:f})})}}function P(e,t,l,o,r,s,a,i,f){const{clientX:d,clientY:c}=e,{$refs:u,scrollbarWidth:p}=t,m=u.leftContainer,h=u.rightContainer,g=d-o,w=c-r,v=i.scrollLeft,C=f.scrollTop;let x=g+(v-s);let b,R,y=0;m&&(y=m.offsetWidth,b=n(m)),h&&(R=n(h));const A=i.scrollWidth-i.offsetWidth-v;return b&&R?"left"===l?d>R.left?x=g+v+p+A:d<b.left+y&&(x=g):"right"===l?d<b.left+y?x=g-p-A-v:d<R.left&&(x=g-p-A):d<b.left+y?x=g-p-A-v:d>R.left&&(x=g+v+p+A):b?"left"===l?d<b.left+y&&(x=g):d<b.left+y&&(x=g-p-A-v):R&&("right"===l?d<R.left&&(x=g-p-A):d>R.left&&(x=g+v+p+A)),{moveX:g,moveY:w,offsetLeft:x,offsetTop:w+(C-a)}}function G(e,t){const{$vxe:l,fnrStore:o}=e,{modal:r}=l;if(o.showREErr=!1,o.findCellRE=null,o.isRE)try{o.findCellRE=new RegExp(t,o.isSensitive?"":"i")}catch(t){return o.showREErr=!0,r&&r.message({message:l.t("vxe.pro.fnr.reError"),status:Ne,id:Le}),!1}return!0}function J(e,t,l,o){if(l.property){const{fnrStore:r,fnrOpts:n}=e,{isWhole:s,isRE:a,isSensitive:i,findCellRE:f}=r,{findMethod:d}=n;let c=Re(Ie(t,l.property));return d?d({cellValue:c,isWhole:s,isRE:a,isSensitive:i,findValue:o,findRE:f}):o?a?f&&f.test(c):(i||(c=c.toLowerCase(),o=o.toLowerCase()),s?c===o:-1<he(c,o)):!c}return!1}function Q(e,t,l,o,r,n,s,a,i,f){const{afterFullData:d,visibleColumn:c}=e,u=[];for(let p=l,m=t.length;p<m;p++){const m=t[p],{rows:h,cols:w}=m,v=he(d,Te(h)),C=he(c,Te(w));for(let t=p===l?r:0,x=h.length;t<x;t++){const h=v+t;for(let v=p===l&&t===r?s:0,x=w.length;v<x;v++){const l=C+v,r=g(e,h,l);if(r){const{row:e,col:t}=r;if(h!==e||l!==t)continue}const s=d[h],w=c[l];if(J(e,s,w,i)&&(u.push({_rowIndex:h,_columnIndex:l,offsetArea:m,offsetRow:s,offsetColumn:w}),!f))return u;if(p>=o&&t>=n&&v>=a)return u}}}return u}function U(e,t,l,o,r,n,s){const{afterFullData:a,visibleColumn:i}=e,f=he(a,t),d=he(i,l)+1,c=he(a,o),u=he(i,r)+1,p=[];for(let m=0,h=a.length;m<h;m++){const t=f+m;for(let l=0==m?d:0,o=i.length;l<o;l++){const o=g(e,t,l);if(o){const{row:e,col:r}=o;if(t!==e||l!==r)continue}const r=a[t],f=i[l];if(J(e,r,f,n)&&(p.push({_rowIndex:t,_columnIndex:l,offsetRow:r,offsetColumn:f}),!s))return p;if(m>=c&&l>=u)return p}}return p}function Z(e){const{$vxe:t}=e,{modal:l}=t;e.$nextTick(()=>{const t=l.get("VXE_FNR");if(t){const l=r(t.$el,".vxe-table--fnr-form-input .vxe-input--inner");l&&(e.blur(),l.focus())}})}function ee(e,t){const{afterFullData:l,visibleColumn:o,fnrStore:r}=e,n=e.getActiveCellArea(),s=e.getCellAreas();let a=Te(l),i=Te(o),f=Fe(l),d=Fe(o);const c=Re(r.findValue);let u=[],p=!0;if(r.showREErr=!1,!G(e,c))return u;if(n){const{row:l,column:o}=n;p=N(e,s,l,o),!t&&p&&(a=l,i=o)}if(!p){const{area:l,row:o,column:r}=n;let a=t?0:be(s,e=>e===l);const i=s[a];if(i){const{cols:l,rows:n}=i;let f=t?0:he(n,o),d=t?0:he(l,r)+1,p=s.length-1;const m=s[p];let h=m.rows.length-1,g=m.cols.length-1;if(u=Q(e,s,a,p,f,h,d,g,c,t),!t&&(u.length||(p=a,h=f,g=d,a=0,f=0,d=0,u=Q(e,s,a,p,f,h,d,g,c,t)),u.length)){const{offsetArea:t,offsetRow:l,offsetColumn:o}=u[0];e.scrollToRow(l,o).then(()=>{e.setActiveCellArea({area:t,column:o,row:l})})}}}else if(u=U(e,a,i,f,d,c,t),!t&&(u.length||(f=a,d=i,a=Te(l),i=Te(o),u=U(e,a,i,f,d,c,t)),u.length)){const{offsetRow:t,offsetColumn:l}=u[0];e.scrollToRow(t,l),e.setCellAreas([{type:$e,startRow:t,endRow:t,startColumn:l,endColumn:l}])}return u}function te(e){we(e.fnrSearchList,e=>{e.isActived=!1})}function le(e,t){const{$vxe:l,fnrOpts:o,fnrStore:r,fnrTabs:n}=e,{modal:s}=l,a=e.getActiveCellArea(),i=n.filter(e=>"find"===e.value&&o.isFind||"replace"===e.value&&o.isReplace),f=-1<i.indexOf(t)?t:i[0];f&&(r.visible=!0,r.activeTab=f.value,r.findValue=a?Ie(a.row,a.column.property):"",s.open({id:"VXE_FNR",title:l.t("vxe.pro.fnr.title"),className:"vxe-table--ignore-areas-clear vxe-table--fnr",size:e.vSize,width:540,minWidth:540,height:370,minHeight:370,resize:!0,lockView:!1,mask:!1,escClosable:!0,events:{hide(){const{fnrStore:t}=e;t.visible=!1,t.showCount=!1,e.fnrSearchList=[],e.focus()},show(){Z(e)}},slots:{default(t,l){const{$vxe:o,fnrStore:r,fnrSearchList:n}=e,{$modal:s}=t,{activeTab:a,isRE:f,showREErr:d}=r,c=[],u="vxe-table--fnr-";return"replace"===a&&c.push(l("vxe-button",{on:{click:e.triggerFNRReplaceAllEvent}},o.t("vxe.pro.fnr.btns.replaceAll")),l("vxe-button",{on:{click:e.triggerFNRReplaceEvent}},o.t("vxe.pro.fnr.btns.replace"))),c.push(l("vxe-button",{on:{click:e.triggerFNRFindAllEvent}},o.t("vxe.pro.fnr.btns.findAll")),l("vxe-button",{key:"findNext",props:{status:"primary"},on:{click:e.triggerFNRFindEvent}},o.t("vxe.pro.fnr.btns.findNext")),l("vxe-button",{on:{click(){s.close()}}},o.t("vxe.pro.fnr.btns.cancel"))),[l("div",{staticClass:u+"tabs"},i.map((t,r)=>l("span",{key:r,class:{"is--active":a===t.value},on:{click(l){e.triggerFNRTabChangeEvent(l,t)}}},o.t(t.label)))),l("div",{staticClass:u+"body"},[l("table",{staticClass:u+"form",attrs:{cellspacing:0,cellpadding:0,border:0}},[l("tbody",[l("tr",{staticClass:"is--visible"},[l("td",{staticClass:u+"form-title"},o.t("vxe.pro.fnr.findTitle")),l("td",{staticClass:u+"form-content"},[l("vxe-input",{staticClass:u+"form-input",props:{value:r.findValue,clearable:!0},on:{input(e){r.findValue=e},keydown:e.triggerFNRFindKeydownEvent}})]),l("td",{staticClass:u+"form-filter",attrs:{rowspan:2}},[l("vxe-checkbox",{props:{value:f,content:o.t("vxe.pro.fnr.filter.re")},on:{input(e){r.isRE=e}}}),l("vxe-checkbox",{props:{value:!f&&r.isWhole,disabled:f,content:o.t("vxe.pro.fnr.filter.whole")},on:{input(e){r.isRE||(r.isWhole=e)}}}),l("vxe-checkbox",{props:{value:r.isSensitive,content:o.t("vxe.pro.fnr.filter.sensitive")},on:{input(e){r.isSensitive=e}}})])]),l("tr",{class:{"is--visible":"replace"===r.activeTab}},[l("td",{staticClass:u+"form-title"},o.t("vxe.pro.fnr.replaceTitle")),l("td",{staticClass:u+"form-content"},[l("vxe-input",{staticClass:u+"form-input",props:{value:r.replaceValue,clearable:!0},on:{input(e){r.replaceValue=e},keydown:e.triggerFNRReplaceKeydownEvent}})])])])])]),l("div",{staticClass:u+"footer"},c),l("div",{staticClass:u+"search"},[l("div",{staticClass:u+"search-header"},[l("div",o.t("vxe.pro.fnr.header.seq")),l("div",o.t("vxe.pro.fnr.header.cell")),l("div",o.t("vxe.pro.fnr.header.value"))]),l("div",{staticClass:u+"search-body"},[l("vxe-list",{staticClass:u+"search-list",props:{data:n,autoResize:!0,scrollY:{gt:10,sItem:u+"find-item"}},scopedSlots:{default(t,l){const{items:o}=t;return o.map(t=>l("div",{key:t.seq,class:[u+"find-item",{"is--active":t.isActived}],on:{click(l){e.triggerFNRItemEvent(l,t)}}},[l("div",t.seq),l("div","Row:"+(t.row+1)+", Col:"+(t.col+1)),l("div",t.value)]))}}})]),l("div",{class:[u+"search-footer",{"is--error":d,"is--visible":d||r.showCount}]},d?o.t("vxe.pro.fnr.reError"):o.t("vxe.pro.fnr.recordCount",[r.findCount]))])]}}}))}function oe(e,t){const{mouseConfig:l,mouseOpts:o,fnrStore:r}=e;return l&&o.area&&(e.fnrStore.visible?t.value!==r.activeTab&&(r.activeTab=t.value,Z(e)):le(e,t)),e.$nextTick()}function re(e,t){const{editStore:l,keyboardConfig:r,keyboardOpts:n,editConfig:s,editOpts:a,highlightCurrentRow:i,bodyCtxMenu:f,fnrOpts:d,filterStore:c}=t,{actived:u}=l,{activeMethod:p}=a,{keyCode:m}=e,g=32===m,w=27===m,v=37===m,b=38===m,R=39===m,y=40===m,A=8===m,I=46===m,E=88===m,T=67===m,F=70===m,S=e.metaKey,$=e.ctrlKey,D=e.shiftKey,k=t.getActiveCellArea(),L=s&&u.column&&u.row;let N;if(c.visible)return void(w&&t.closeFilter());if(g&&k&&r&&n.isChecked&&("checkbox"===k.column.type?(o(e),t.handleToggleCheckRowEvent(e,{row:k.row,column:k.column})):"radio"===k.column.type&&(o(e),t.triggerRadioRowEvent(e,{row:k.row,column:k.column}))),w&&s)t.closeMenu(),t.closeFilter(),h(e,t);else if(113===m&&s&&k){if(!L){const{offsetRow:l,offsetColumn:r}=x(t,k.row,k.column);r.editRender&&(N={row:l,column:r,cell:t.getCell(l,r)},o(e),t.handleActived(N,e))}}else if(93===m)t._keyCtx=k&&k.row&&k.column&&f.length,clearTimeout(t.keyCtxTimeout),t.keyCtxTimeout=setTimeout(()=>{t._keyCtx=!1},1e3);else if($&&77===m&&r&&n.isMerge&&k)L||(o(e),C(t,e),t.clearCopyCellArea());else if($&&r&&n.isFNR&&(F&&d.isFind||72===m&&d.isReplace)){o(e);const l=t.fnrTabs[F?0:1];t.fnrStore.visible?t.triggerFNRTabChangeEvent(e,l):t.triggerFNROpenEvent(e,l.value),h(e,t)}else if(13===m&&r&&n.isEnter){const{column:l,row:r}=u;if(l&&r){const{offsetRow:s,offsetColumn:a}=x(t,r,l);o(e),t.clearActived(),n.enterToTab?B(e,t,{row:s,column:a},D):K(e,t,{row:s,column:a},!1,D,!1,!D)}else k&&(o(e),n.enterToTab?B(e,t,k,D):K(e,t,k,!1,D,!1,!D))}else if((v||b||R||y)&&r&&n.isArrow)L||(k?D?j(e,t,k,v,b,R,y):K(e,t,k,v,b,R,y):(b||y)&&i&&t.moveCurrentRow(b,y,e));else if(9===m&&r&&n.isTab){const{column:l,row:r}=u;if(r&&l){const{offsetRow:n,offsetColumn:s}=x(t,r,l);o(e),t.clearActived(),B(e,t,{row:n,column:s},D)}else k&&(o(e),B(e,t,k,D))}else if((I||A)&&r&&n.isDel){if(!L)if(A&&k){const{column:l,row:o}=k;if(o&&l){const{offsetRow:r,offsetColumn:n}=x(t,o,l);n.editRender&&(N={row:r,column:n},(!p||p(N))&&(N.cell=t.getCell(r,n),Ee(r,n.property,null),t.handleActived(N,e)))}}else if(I){const e=t.getCellAreas();we(e,e=>{const{rows:t,cols:l}=e;we(t,e=>{we(l,t=>{t.editRender&&(!p||p({row:e,column:t}))&&Ee(e,t.property,null)})})})}}else if(r&&$&&65===m)L||t.triggerAllCellAreaEvent(e);else if(r&&$&&Se.msie&&(E||T||86===m)){if(!L){const l=window.clipboardData;if(l)if(E||T){const{text:o}=W(t,e,E);l.setData("text",o)}else{const o=l.getData("text");V(t,e,{text:o})}}}else if(r&&s&&n.isEdit&&!$&&!S&&(g||48<=m&&57>=m||65<=m&&90>=m||96<=m&&111>=m||186<=m&&192>=m||219<=m&&222>=m)&&!L&&k){const{column:l,row:o}=k;if(o&&l){const{offsetRow:r,offsetColumn:s}=x(t,o,l),{editMethod:a}=n;s.editRender&&(N={row:r,column:s},(!a||!1!==a(N,e))&&(N.cell=t.getCell(r,s),(!p||p(N))&&(Ee(r,s.property,null),t.handleActived(N,e))))}}}function ne(e,o,s){const{fixed:d}=s,c=o.getCellAreas(),u=ve(c,e=>e.type===$e);if(t(o),u){const c=document.onmousemove,p=document.onmouseup,{$el:m,$refs:h,$vxe:w,elemStore:v,afterFullData:C,visibleColumn:x}=o,{modal:b}=w,A=e.clientX,I=e.clientY,{tableBody:F,rightBody:S,tableFooter:D}=h,k=F?F.$el:null,W=S?S.$el:null,V=D?D.$el:null,N=W||k,M=V||k,{cols:H,rows:O}=u,Y=Te(H),_=Te(O),X=Fe(H),K=Fe(O),j=u.top,q=u.left,z=u.width,B=u.height,G=v[`${Y.fixed||"main"}-body-wrapper`]||v["main-body-wrapper"],J=r(G,".vxe-table--cell-area"),Q=J.children[2],U=N.scrollTop,Z="left"===d?0:M.scrollLeft,ee=he(C,K),te=he(x,X),le=g(o,ee,te);let oe,re=1,ne=1,se=0,ie=0,de=null,ue=null;const me=r(G,".vxe-body--row"),ge=me.firstChild,we={el:null,type:ke,top:0,left:0,width:0,height:0},ve=e=>{const{offsetTop:t,offsetLeft:l}=P(e,o,d,A,I,Z,U,M,N),r=ae(t),n=ae(l),s=M.scrollWidth,a=N.scrollHeight;let i=B,f=z,c=j,u=q;switch(oe){case"top":if(t<-B){const e=fe(j,R(o,_,Y,le,!1,r-B));c-=e,i+=e}break;case"bottom":0<t&&(i+=fe(a-j-B,R(o,K,X,le,!0,r)));break;case"left":if(l<-z){const e=fe(q,y(o,_,Y,le,!1,n-z));u-=e,f+=e}break;case"right":0<l&&(f+=fe(s-q-z,y(o,K,X,le,!0,n)));}we.height=i,we.width=f,we.left=u,we.top=c,we.cols=E(o,ge,we),we.rows=T(o,me,we),pe(we,$(o,we))},Ce=e=>{t(o),o._msTout=setTimeout(()=>{if(o._msTout){const{clientHeight:l,clientWidth:r}=k,{scrollLeft:n,scrollWidth:s}=M,{scrollTop:a,scrollHeight:i}=N;let f,d;null!==de&&(de?a+l<i&&(f=a+re*Me):a&&(f=a-re*Me)),null!==ue&&(ue?n+r<s&&(d=n+ne*Me):n&&(d=n-ne*Me)),ce(d)||ce(f)?(o.scrollTo(d,f),Ce(e),ve(e)):t(o)}},50)};document.onmousemove=e=>{l(e);const{clientY:r,clientX:s}=e,{clientHeight:a,clientWidth:i}=k,{offsetTop:f,offsetLeft:c}=P(e,o,d,A,I,Z,U,M,N),u=n(k),p=u.top,m=u.left,h=q+z+c,g=j+B+f;let w;de=null,ue=null,se=r,ie=s,se<p?(w=!0,de=!1,re=p-se):se>p+a&&(w=!0,de=!0,re=se-p-a),ie<m?(w=!0,ue=!1,ne=m-ie):ie>m+i&&(w=!0,ue=!0,ne=ie-m-i),h<q?g>j&&g<j+B&&(oe="left"):h>q+z?g>j&&g<j+B&&(oe="right"):g<j?oe="top":g>j+B&&(oe="bottom"),w?!o._msTout&&Ce(e):t(o),ve(e)},document.onmouseup=()=>{document.onmousemove=c,document.onmouseup=p,t(o),f(m,"drag--extend-range");const l=T(o,me,we),r=E(o,ge,we);L(o,l,r)?(u.rows=l,u.cols=r):b&&b.message({message:w.t("vxe.pro.area.extendErr"),status:Ne,id:Le}),pe(u,$(o,u)),a(Q),o._isCAEd=!1,o.emitEvent("cell-area-extension-end",{rows:u.rows,cols:u.cols},e)},i(m,"drag--extend-range"),o._isCAEd=!0,o.emitEvent("cell-area-extension-start",s,e)}}function se(e,c,p){const{$el:m,$refs:h,elemStore:g,editStore:v,editOpts:C,_isCAEd:x}=c,{actived:R}=v,{fixed:y,row:F,column:S,cell:D}=p;if(x)return void o(e);if(R.row===F&&("cell"===C.mode?R.column===S:"row"===C.mode))return;const k=2===e.button,W=e.ctrlKey,V=D.offsetTop,L=D.offsetLeft,N=D.offsetWidth,M=D.offsetHeight;let H=c.getCellAreas();if(t(c),c.clearActived(e),c.clearSelected(e),!k||!Ae(H,e=>e.top<=V&&V<e.top+e.height&&e.left<=L&&L<e.left+e.width)){W||(H=[],c.clearCellAreas());const o=document.onmousemove,v=document.onmouseup,C=e.clientX,x=e.clientY,R=g[`${S.fixed||"main"}-body-wrapper`]||g["main-body-wrapper"],O=r(R,".vxe-table--cell-area"),Y=O.children,_=Y[0],X=Y[2],K=Y[3],j=w(e,D),{tableBody:q,rightBody:z,tableFooter:B}=h,G=q?q.$el:null,J=z?z.$el:null,Q=B?B.$el:null,U=J||G,Z=Q||G,ee=D.parentNode,te=r(R,".vxe-body--row"),le=te.firstChild,oe=U.scrollTop,re="left"===y?0:Z.scrollLeft;let ne=null,se=null,ie=1,de=1,ue=0,me=0;const he={el:null,type:W?We:$e,cols:[],rows:[],top:0,left:0,width:0,height:0},ge={el:null,type:Ve,area:he,column:S,row:F,top:D.offsetTop,left:D.offsetLeft,width:D.offsetWidth,height:D.offsetHeight};if(W){const e=y?`${y}El`:"el",t=ve(H,e=>e.type===$e);t&&(t.type=We,t[e]=d(K),u(t[e],t)),he[e]=d(K)}c.setActiveCellArea(ge),H.push(he),c.activeCellArea=ge;const we=e=>{const{offsetTop:t,offsetLeft:l}=P(e,c,y,C,x,re,oe,Z,U),o=Z.scrollWidth,r=U.scrollHeight,n=0<=t,i=0<=l;let f,d,u=ae(t),p=ae(l);n?(f=A(c,F,S,ee,n,u+j.offsetY),u=fe(r-V,f.moveHeight)):(f=A(c,F,S,ee,n,u-j.offsetY),u=fe(V+M,f.moveHeight)),i?(d=I(c,F,S,D,i,p+j.offsetX),p=fe(o-L,d.moveWidth)):(d=I(c,F,S,D,i,p-j.offsetX),p=fe(L+N,d.moveWidth));const{rows:m,cols:h}=b(c,f.rows,d.cols);he.rows=m,he.cols=h,a(X),W?(a(_),s(K)):(a(K),s(_)),pe(he,$(c,he))},Ce=e=>{t(c),c._msTout=setTimeout(()=>{if(c._msTout){const{clientHeight:l,clientWidth:o}=G,{scrollLeft:r,scrollWidth:n}=Z,{scrollTop:s,scrollHeight:a}=U;let i,f;null!==ne&&(ne?s+l<a&&(i=s+ie*Me):s&&(i=s-ie*Me)),null!==se&&(se?r+o<n&&(f=r+de*Me):r&&(f=r-de*Me)),ce(f)||ce(i)?(c.scrollTo(f,i),Ce(e),we(e)):t(c)}},50)};k||(document.onmousemove=e=>{l(e);const{clientY:o,clientX:r}=e,{clientHeight:s,clientWidth:a}=G,i=n(G),f=i.top,d=i.left;let u;ne=null,se=null,ue=o,me=r,ue<f?(u=!0,ne=!1,ie=f-ue):ue>f+s&&(u=!0,ne=!0,ie=ue-f-s),me<d?(u=!0,se=!1,de=d-me):me>d+a&&(u=!0,se=!0,de=me-d-a),u?!c._msTout&&Ce(e):t(c),we(e)}),document.onmouseup=()=>{document.onmousemove=o,document.onmouseup=v,t(c),he.cols=E(c,le,he),he.rows=T(c,te,he),f(m,"drag--area"),c.emitEvent("cell-area-selection-end",{rows:he.rows,cols:he.cols},e)},i(m,"drag--area"),we(e),c.cellAreas=H,c.emitEvent("cell-area-selection-start",p,e)}}const{isNumber:ce,browse:ue,assign:pe,slice:me,indexOf:he,includes:ge,arrayEach:we,find:ve,findLast:Ce,findLastIndexOf:xe,findIndexOf:be,toString:Re,filter:ye,some:Ae,get:Ie,set:Ee,first:Te,last:Fe}=e,Se=ue(),$e=0,De=1,ke=2,We=3,Ve=4,Le="operErr",Ne="error",Me=4;"undefined"!=typeof window&&(window.VXETableMixin={data(){return{fnrStore:{visible:!1,activeTab:null,findValue:null,replaceValue:null,isRE:!1,isWhole:!1,isSensitive:!1,showREErr:!1,showCount:!1,findCount:0},fnrSearchList:[],fnrTabs:[{value:"find",label:"vxe.pro.fnr.tabs.find"},{value:"replace",label:"vxe.pro.fnr.tabs.replace"}]}},beforeDestroy(){const{$vxe:e}=this;e.modal.close("VXE_FNR")},methods:{handleHeaderCellAreaEvent(e,t){const{afterFullData:l}=this,{triggerFilter:o,column:r}=t;o?this.clearCopyCellArea():l.length?setTimeout(()=>{const e=Te(l);this.$nextTick(()=>{this.clearCopyCellArea(),this.setCellAreas([{type:$e,startColumn:r,endColumn:r,startRow:e,endRow:Fe(l)}],{column:r,row:e})}),this.scrollToRow(e,r)},10):(this.clearCellAreas(),this.clearCopyCellArea())},handleUpdateCellAreas(){const e=this.getActiveCellArea(),t=this.getCellAreas();t.length&&this.$nextTick(()=>{const{copyAreaMpas:l,afterFullData:o,visibleColumn:r}=this,n=[];if(we(t,e=>{const{type:t,cols:l,rows:s}=e,a=ve(l,e=>ge(r,e)),i=ve(s,e=>ge(o,e));if(i&&a){const e=Ce(l,e=>ge(r,e)),f=Ce(s,e=>ge(o,e));n.push({type:t,startColumn:a,endColumn:e,startRow:i,endRow:f})}}),n.length?(e&&(e.area=n[he(t,e.area)]),this.setCellAreas(n,e)):this.clearCellAreas(),l){const{cols:e,rows:t}=l,n=be(e,e=>ge(r,e)),s=be(t,e=>ge(o,e));if(-1<n&&-1<s){const a=xe(e,e=>ge(r,e)),i=xe(t,e=>ge(o,e));l.cols=me(e,n,a+1),l.rows=me(t,s,i+1),this.copyAreaMpas=$(this,l)}}})},_getCellAreas(){return this.cellAreas||[]},_clearCellAreas(){return p(this,e=>{const t=e.children,l=t[0],o=t[2],r=t[3],n=t[4];if(a(l),a(l.firstChild),a(o),a(n),r){const e=r.children;for(let t=e.length-1;0<=t;t--)r.removeChild(e[t])}}),this.activeCellArea=null,this.cellAreas=[],this.$nextTick()},_getCopyCellArea(){return this.copyAreaMpas||null},_clearCopyCellArea(){return m(this,De),this.copyAreaMpas=null,this.$nextTick()},_setCellAreas(e,t){if(e&&e.length){this.clearCellAreas();const l=ve(e,e=>e.type===$e);let o=[];if(l){const e=D(this,l);o=e?[e]:[]}else{const t=[];we(e,e=>{const l=D(this,e);l&&t.push(l)}),o=t}if(o.length){const l=o[0],{cols:r,rows:n}=l;t&&t.area&&(t.area=o[he(e,t.area)]),this.setActiveCellArea(pe({type:Ve,area:l,column:Fe(r),row:Fe(n)},t))}this.cellAreas=o}return this.$nextTick()},_setActiveCellArea(e){return m(this,Ve),e.type=Ve,this.activeCellArea=F(this,e),this.$nextTick()},_getActiveCellArea(){return this.activeCellArea||null},handleKeyboardEvent(e){re(e,this)},_openFind(){const{fnrTabs:e,fnrOpts:t}=this;return t.isFind?oe(this,e[0]):this.$nextTick()},_openReplace(){const{fnrTabs:e,fnrOpts:t={}}=this;return t.isReplace?oe(this,e[1]):this.$nextTick()},triggerFNROpenEvent(e,t){const{fnrStore:l,fnrTabs:o}=this;oe(this,ve(o,e=>e.value===t)||o[0]),this.emitEvent("open-fnr",{tab:l.activeTab},e)},triggerFNRTabChangeEvent(e,t){const{fnrStore:l}=this;l.activeTab!==t.value&&(l.activeTab=t.value,Z(this),this.emitEvent("change-fnr",{tab:l.activeTab},e))},triggerFNRFindKeydownEvent(e){const{$event:t}=e;13===t.keyCode&&("replace"===this.fnrStore.activeTab?this.triggerFNRReplaceEvent(e):this.triggerFNRFindEvent(e))},triggerFNRFindEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,{beforeFindMethod:r}=l,n=Re(t.findValue);if(!t.showREErr&&!(r&&!1===r({findValue:n,$table:this}))){const t=ee(this);te(this),!t.length&&o&&o.message({message:e.t("vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})}},triggerFNRFindAllEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,{beforeFindMethod:r}=l,n=Re(t.findValue);if(this.fnrSearchList=[],t.showREErr)return;if(r&&!1===r({findValue:n,$table:this}))return;const s=ee(this,!0);t.findCount=s.length,t.showCount=!0,s.length?setTimeout(()=>{this.fnrSearchList=s.map((t,l)=>{const o=Re(Ie(t.offsetRow,t.offsetColumn.property));return{seq:l+1,row:t._rowIndex,col:t._columnIndex,isActived:!1,value:o||e.t("vxe.pro.fnr.empty")}})},10):o&&o.message({message:e.t("vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})},triggerFNRItemEvent(e,t){const{afterFullData:l,visibleColumn:o}=this,r=l[t.row],n=o[t.col];r&&n&&(te(this),t.isActived=!0,this.scrollToRow(r,n),this.setCellAreas([{type:$e,startRow:r,endRow:r,startColumn:n,endColumn:n}]))},triggerFNRReplaceKeydownEvent(e){const{$event:t}=e;13===t.keyCode&&this.triggerFNRReplaceEvent(e)},triggerFNRReplaceEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,r=this.getActiveCellArea(),n=Re(t.findValue),s=Re(t.replaceValue);if(G(this,n)&&(n||s))if(r){const{beforeReplaceMethod:t,replaceMethod:a}=l,{row:i,column:f}=r;if(t&&!1===t({findValue:n,replaceValue:s,$table:this}))return;J(this,i,f,n)?(a?a({row:i,column:f,cellValue:s}):Ee(i,f.property,s),ee(this),te(this)):o&&o.message({message:e.t("vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})}else o&&o.message({message:e.t("vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})},triggerFNRReplaceAllEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,r=Re(t.findValue),n=Re(t.replaceValue);if(r||n){const{beforeReplaceMethod:s,replaceMethod:a}=l;if(t.showREErr)return;if(s&&!1===s({findValue:r,replaceValue:n,$table:this}))return;const i=ee(this,!0);te(this),i.length?(we(i,e=>{const{offsetRow:t,offsetColumn:l}=e;a?a({row:t,column:l,cellValue:n}):Ee(t,l.property,n)}),o&&o.message({message:e.t("vxe.pro.fnr.replaceSuccess",[i.length]),status:"success",id:"operEnd"})):o&&o.message({message:e.t("vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})}},triggerAllCellAreaEvent(e){const{afterFullData:t,visibleColumn:l}=this;t.length&&l.length&&(o(e),this.setCellAreas([{type:$e,startRow:Te(t),endRow:Fe(t),startColumn:Te(l),endColumn:Fe(l)}]))},handleCopyCellAreaEvent(e){const{text:t,html:l}=W(this,e),o=e.clipboardData;o.setData("text/plain",t),o.setData("text/html",l)},handleCutCellAreaEvent(e){const{text:t,html:l}=W(this,e,!0),o=e.clipboardData;o.setData("text/plain",t),o.setData("text/html",l)},handlePasteCellAreaEvent(e){const t=e.clipboardData,l=t.getData("text/plain");V(this,e,{text:l})},_copyCellArea(){return W(this,null)},_cutCellArea(){return W(this,null,!0)},_pasteCellArea(){const{$vxe:e}=this,{clipboard:t}=e;return t&&(t.html||t.text)&&V(this,null,t),this.$nextTick()},triggerCellExtendMousedownEvent(e,t){ne(e,this,t)},handleCellAreaEvent(e,t){se(e,this,t)}}})})(XEUtils);